{
  "hash": "cc2333379c3fb9bd925d86ff86ecb49d",
  "result": {
    "markdown": "---\ntitle: \"Machine learning model visualization\"\nauthor: \"Sai manikanta praneeth perala\"\ndate: \"2023-12-06\"\ncategories: [news, code, analysis,plotly,plot]\nimage: \"image.jpg\"\n---\n\n\n***This R code utilizes ggplot2, corrplot, caret, and Metrics to analyze a synthetic dataset. It starts with summary statistics, visualizes relationships with scatter plots, and depicts correlations using a color-coded matrix. The main focus is on a linear regression model predicting 'mpg' based on 'wt.' The model's summary and evaluation metrics, including RMSE, are provided. The ggplot2 package is then used to visualize the regression line on a scatter plot of 'wt' versus 'mpg,' offering a concise exploration of the dataset and the linear regression model.***\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ncorrplot 0.92 loaded\n```\n:::\n\n```{.r .cell-code}\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lattice\n```\n:::\n\n```{.r .cell-code}\nlibrary(Metrics)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'Metrics' was built under R version 4.3.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Metrics'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:caret':\n\n    precision, recall\n```\n:::\n\n```{.r .cell-code}\n# Create a dataframe with random values\nset.seed(123)\nn <- 100\nrandom_df <- data.frame(\n  mpg = rnorm(n, mean = 25, sd = 5),\n  wt = rnorm(n, mean = 3, sd = 1),\n  disp = rnorm(n, mean = 200, sd = 50),\n  hp = rnorm(n, mean = 120, sd = 30)\n)\n\n# EDA: Summary statistics and structure of the dataset\nsummary(random_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      mpg              wt              disp             hp        \n Min.   :13.45   Min.   :0.9468   Min.   :112.2   Min.   : 46.02  \n 1st Qu.:22.53   1st Qu.:2.1989   1st Qu.:173.4   1st Qu.: 98.12  \n Median :25.31   Median :2.7742   Median :201.8   Median :119.89  \n Mean   :25.45   Mean   :2.8925   Mean   :206.0   Mean   :118.91  \n 3rd Qu.:28.46   3rd Qu.:3.4678   3rd Qu.:238.2   3rd Qu.:140.66  \n Max.   :35.94   Max.   :6.2410   Max.   :314.7   Max.   :197.14  \n```\n:::\n\n```{.r .cell-code}\nstr(random_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t100 obs. of  4 variables:\n $ mpg : num  22.2 23.8 32.8 25.4 25.6 ...\n $ wt  : num  2.29 3.26 2.75 2.65 2.05 ...\n $ disp: num  310 266 187 227 179 ...\n $ hp  : num  98.5 97.4 91.8 88.4 106.9 ...\n```\n:::\n\n```{.r .cell-code}\n# Scatter plots for selected relationships\npairs(random_df, col = \"#FFA500\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Correlation matrix visualization\ncorrelation_matrix <- cor(random_df)\ncorrplot(correlation_matrix, method = \"color\", col = colorRampPalette(c(\"#B2DF8A\", \"#1F78B4\"))(20))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Linear Regression Model\n# Assume mpg as the dependent variable and wt as the independent variable\nmodel <- lm(mpg ~ wt, data = random_df)\n\n# Model summary\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = mpg ~ wt, data = random_df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-11.9575  -2.9785  -0.2153   2.9612  10.6502 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  26.1282     1.4516  18.000   <2e-16 ***\nwt           -0.2338     0.4762  -0.491    0.625    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.582 on 98 degrees of freedom\nMultiple R-squared:  0.002453,\tAdjusted R-squared:  -0.007726 \nF-statistic: 0.241 on 1 and 98 DF,  p-value: 0.6246\n```\n:::\n\n```{.r .cell-code}\n# Predictions\npredictions <- predict(model, random_df)\n\n# Model evaluation\nrmse_value <- rmse(predictions, random_df$mpg)\ncat(\"Root Mean Squared Error (RMSE):\", rmse_value, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRoot Mean Squared Error (RMSE): 4.535627 \n```\n:::\n\n```{.r .cell-code}\n# Visualization of the linear regression line\nggplot(random_df, aes(x = wt, y = mpg)) +\n  geom_point(color = \"#FFA500\", size = 3) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"#E41A1C\", linetype = \"dashed\", size = 1.5) +\n  labs(title = \"Linear Regression: MPG vs Weight\",\n       x = \"Weight\", y = \"Miles per Gallon\") +\n  theme_minimal() +\n  theme(plot.title = element_text(color = \"#4DAF4A\", size = 16, face = \"bold\"),\n        axis.title.x = element_text(color = \"#377EB8\", size = 14),\n        axis.title.y = element_text(color = \"#FF7F00\", size = 14),\n        axis.text = element_text(color = \"#333333\", size = 12),\n        legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nâ„¹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}